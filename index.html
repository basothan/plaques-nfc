<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Activer ma plaque</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
    />
    <style>
      :root { --brand-gold: #C7A85B; }
      .btn-gold { background-color: var(--brand-gold); }
      .btn-gold:hover { filter: brightness(0.95); }
      .input-pill {
        /* Tailwind @apply can't run here; use equivalent styles */
        width: 100%;
        border-radius: 9999px;
        border: 2px solid #d1d5db; /* gray-300 */
        padding: 0.75rem 1rem;
        box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        background: #fff;
        outline: none;
      }
      .input-pill:focus {
        box-shadow: 0 0 0 4px rgba(0,0,0,0.04);
        border-color: #000;
      }

      /* Overlay / progress */
      @keyframes redirect-load {
        0%   { width: 0%;   }
        100% { width: 100%; }
      }
      .progress-bar {
        width: 220px; height: 6px; background: rgba(0,0,0,0.08);
        border-radius: 9999px; overflow: hidden;
      }
      .progress-bar > span {
        display: block; height: 100%; width: 0;
        animation: redirect-load 1.2s linear infinite;
        background: #000;
      }
    </style>
  </head>
  <body class="bg-gray-50 min-h-screen">
    <div class="mx-auto max-w-lg p-6">
      <div class="flex items-center gap-3 mb-6">
        <img src="/logo.png" alt="logo" class="h-10 w-auto" />
      </div>

      <div class="bg-white p-8 rounded-2xl shadow-md">
        <h1 class="text-2xl font-bold mb-2 text-left">ACTIVER MA PLAQUE</h1>

        <p class="text-gray-600 mb-4 text-left">
          Entrez votre <strong>numéro de plaque</strong> et votre <strong>lien Google</strong>.
        </p>

        <div id="prefillBox" class="hidden bg-blue-50 text-blue-800 text-sm p-3 rounded-md mb-4 text-left"></div>

        <div class="bg-gray-100 p-3 rounded-md mb-6 text-sm text-gray-700 font-mono text-left">
          Exemple d’URL Google : https://g.page/nom-de-votre-commerce
        </div>

        <form id="activationform" class="space-y-4 text-left">
          <div>
            <label for="code" class="block text-sm font-medium text-gray-700">Numéro de plaque</label>
            <input id="code" name="code" type="text" required placeholder="Ex : A3HJ9" class="input-pill" />
          </div>

          <div>
            <label for="url_google" class="block text-sm font-medium text-gray-700">Lien Google</label>
            <input id="url_google" name="url_google" type="url" required placeholder="https://g.page/mon-commerce" class="input-pill" />
          </div>

          <button type="submit"
            class="w-full inline-flex items-center justify-center px-4 py-3 rounded-full btn-gold text-black font-semibold">
            Activer
          </button>

          <p id="status" class="text-sm text-gray-600"></p>
        </form>

        <!-- Bloc succès : GIF + texte -->
        <div id="ok" class="hidden mt-6 text-center">
          <img src="/activation_ok.gif" alt="activation ok" class="mx-auto h-20" />
          <p class="mt-3 text-green-700 font-semibold text-lg">
            VOTRE PLAQUE EST DÉSORMAIS ACTIVÉE
          </p>
        </div>
      </div>
    </div>

    <!-- Overlay redirection (hidden by default) -->
    <div id="redirectOverlay"
         class="hidden fixed inset-0 bg-white/90 backdrop-blur-sm items-center justify-center z-50">
      <div class="flex flex-col items-center">
        <img src="/logo.png" alt="logo" class="h-16 w-auto mb-4" />
        <div class="progress-bar rounded-full"><span></span></div>
        <p class="mt-3 text-gray-700 text-sm">Redirection en cours…</p>
      </div>
    </div>

    <script defer src="/app.js"></script>
  </body>
</html>
